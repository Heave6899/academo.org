var perlinData =  [0.4644462321301291,0.4689220965982183,0.4733227973966433,0.4775793075220709,0.48162908823176076,0.48541586391781216,0.48888939893819033,0.4920052764045325,0.4947246789267339,0.49701417131431314,0.4988454852345572,0.5001953058274464,0.501045060277359,0.5013807083415548,0.5011925348354399,0.5004749440746095,0.49922625627367084,0.4974485059018471,0.4951472419953589,0.49233133042658717,0.48901275813001455,0.4852064392849472,0.48093002345501623,0.47620370568445797,0.4710500385511751,0.46549374617657685,0.45956154019219864,0.45328193766310176,0.4466850809680529,0.43980255963648285,0.43266723414222497,0.42531306165403404,0.41777492374288344,0.4100884560460437,0.40228987988793896,0.39441583585778417,0.38650321934400256,0.37858901802542066,0.37071015131924545,0.36290331178581925,0.35520480849015557,0.3476504123202538,0.34027520326219424,0.33311341963201224,0.3261983092643525,0.31956198265790237,0.3132352680776057,0.3072475686136556,0.30162672119726747,0.29639885757323126,0.29158826722924325,0.2872172622820187,0.28330604432018264,0.27987257320394066,0.2769324378215305,0.2744987288024523,0.2725819131874781,0.2711897110554427,0.2703269741068123,0.26999556620403475,0.27019424586866553,0.27091855073528137,0.27216068396216214,0.27390940259876556,0.27614990790996774,0.27886373765709627,0.28202866033573293,0.28561857137030383,0.2896033912654417,0.29394896571413587,0.2986169676626538,0.30356480133225006,0.3087455081976489,0.31410767492230973,0.3195953432504709,0.32514792185597347,0.3307187084080228,0.3363296890766479,0.3420142566014286,0.34779885197231414,0.3537034662467465,0.35974212823100216,0.3659233780257546,0.372250726435856,0.378723100244338,0.3853352733506327,0.392078283773014,0.3989398365152563,0.4059046922975155,0.4129550421514277,0.42007086787942827,0.42723028837829097,0.4344098918268854,0.4415850537381557,0.44873024087531743,0.4558193010322749,0.4628257386782582,0.46972297646667904,0.47648460260820735,0.4830846041080663,0.489497585867548,0.4956989756497483,0.5016652149095211,0.5073739354876525,0.512804122169255,0.51793626110638,0.5227524741048518,0.5272366387753196,0.5313744945485295,0.5351537345548173,0.5385640833678191,0.5415973606124032,0.5442475304368197,0.5465107368490724,0.5483853249175075,0.5498718478356237,0.5509730598511018,0.5516938950590529,0.5520414320594873,0.5520248444790027,0.5516553373566916,0.550946069394269,0.5499120610704192,0.5485700886193624,0.546938563873641,0.5450373999711257,0.5428878629262405,0.5405124090654082,0.537934508326715,0.535178453423795,0.532269154873934,0.5292319218903931,0.5260922291389524,0.5228754693586729,0.5196066918468804,0.5163103268083657,0.5130098955688088,0.5097277066524178,0.5064845377237918,0.503299303394,0.500188708890883,0.4971668895935723,0.49424503643123,0.4914310071460073,0.48872892342022434,0.4861387538677666,0.48365588288970585,0.4812706653941341,0.47896796738022474,0.4767266923865059,0.47451929380336,0.4723231607353948,0.47015751793894095,0.46805057290190644,0.46602810549455503,0.4641135369070495,0.4623279985614044,0.46069040099784825,0.45921750273559575,0.4579239791080291,0.4568224910722897,0.45592375399327845,0.4552366064020666,0.4547680787287158,0.4545234620095078,0.45450637656858367,0.4547188406739933,0.4551613391681533,0.455832892072716,0.45673112316784636,0.45785232854591074,0.4591915451395728,0.460742619224301,0.4624982748952846,0.4644501825187599,0.46658902715774586,0.46890457697218907,0.4713857515935189,0.47402069047361217,0.4767968212081664,0.4797009278344848,0.48271921910366905,0.48583739672722176,0.4890407235980603,0.4923140919859379,0.4956420917072765,0.4990090782694075,0.5023992409892233,0.5057966710862382,0.5091854297500579,0.5125496161822609,0.5158734356126874,0.519141267290138,0.5223377324474838,0.525447762241184,0.5284566656652144,0.531350197439405,0.5341146258721879,0.5367368006977539,0.5392042208876187,0.5415051024366001,0.5436284461232035,0.5455641052444171,0.5473028533249179,0.5488364518006853,0.5501577176770268,0.5512605911610108,0.5521402032683111,0.5527929434044601,0.553216526920511,0.553410062643112,0.5533741203789856,0.553110798393824,0.5526237908655871,0.551918455312216,0.5510018799937524,0.5498829512888695,0.5485724210458113,0.5470829739077427,0.5454292946125083,0.5436281352668018,0.5416983825947436,0.5396611251608698,0.5375397205675284,0.5353598626266879,0.5331496485061539,0.5309388119367068,0.528754585844937,0.5266213029509103,0.5245608948656377,0.5225929831903109,0.5207349695316594,0.5190021244334327,0.5174076752240059,0.5159628927801084,0.5146771772066777,0.513558142432835,0.5126116997239865,0.5118421401100464,0.5112522157297856,0.5108432200913029,0.51061506724862,0.5105663698944004,0.5106945163687923,0.5109957465843946,0.5114652268673472,0.5120971237145447,0.5128846764669739,0.5138202688991745,0.514895499724825,0.51610125201845,0.517427761553254,0.518864684055076,0.5204011613724703,0.5220258865629093,0.5237271678951111,0.5254929917674902,0.5273110845427319,0.5291689732984911,0.5310540454942139,0.5329536075540835,0.5348549423660895,0.5367453656972214,0.5386122815247851,0.5404432362838436,0.5422259720307813,0.5439484785229923,0.5455990442146917,0.5471663061688512,0.5486392988852582,0.5500075020446988,0.5512608871692645,0.5523899631987818,0.5533858209833671,0.5542401766921038,0.5549454141378442,0.5554946260181339,0.5558816540722613,0.5561011281544304,0.5561485042230561,0.556020101246185,0.5557131370230388,0.5552257629216819,0.5545570975328121,0.5537072592396761,0.552677397704108,0.5514697242686898,0.5500875412750409,0.5485352702982241,0.5468184792972814,0.5449439086818906,0.542919496295145,0.5407544013124599,0.538459027056599,0.5360450427288274,0.5335254040561874,0.5309143728548971,0.5282275355098746,0.5254818203703834,0.5226955140618039,0.5198882767135278,0.5170738270035904,0.5142392958983042,0.5113693575469109,0.508453502252391,0.5054856386481784,0.5024637079855803,0.49938931053190455,0.4962673440792926,0.49310565456425626,0.4899146987979238,0.48670721930698935,0.4834979312853688,0.4803032216565629,0.47714086024672403,0.4740297230684315,0.47098952771517055,0.46804058086651806,0.46520353790403496,0.4624991746378635,0.45994817114403014,0.4575709077124567,0.45538727290567405,0.45341648372824433,0.4516769179068882,0.4501859582813178,0.4489598493057756,0.44801356566128014,0.44736069297857645,0.44701332067179284,0.446981946882804,0.4472753955362998,0.4479007455055593,0.44886327188893205,0.45016639939702396,0.45181166785059035,0.4537987097891335,0.4561252401902075,0.4587870582994283,0.46177806157118934,0.4650902717200845,0.46871387288303507,0.4726372618921237,0.47684711065813545,0.48132844066480174,0.4860647095737526,0.4910379099401752,0.49622868003917603,0.5016164268028501,0.5071794608680584,0.5128951437349064,0.5187400470359326,0.5246901239160022,0.5307208925229047,0.536807631608659,0.5429255882415263,0.5490501976287239,0.5551573150498496,0.5612234599010106,0.5672260718496567,0.5731437791001216,0.5789566787698698,0.5846466293764478,0.5901975554351424,0.5955957641673463,0.6008302743196258,0.6058931570934999,0.6107798891859186,0.6154897179404529,0.6200260386091899,0.6243967837253293,0.6286148245864897,0.6326983848487228,0.6366714662312285,0.6405642863317774,0.6444137285528437,0.6482619595150974,0.6521466038110177,0.656098391612658,0.6601422285852274,0.6642975986523303,0.6685789557343759,0.672996104460156,0.6775545698515955,0.6822559559816725,0.687098293605508,0.6920763767646265,0.6971820883643886,0.7024047147245895,0.7077312491032346,0.7131466841934779,0.7186342935937364,0.724175902250974,0.7297521458771519,0.7353427193388544,0.7409266140200832,0.7464823441582192,0.7519881621531597,0.7574222628496228,0.7627629767926218]
var doubleGaussianHeights = [0,-8.177801511491352e-9,8.794456408143089e-10,6.411447763941628e-9,1.5311669787739496e-10,-5.000910149302324e-9,-2.040921112430021e-9,5.225424457367557e-9,2.533788545836513e-9,-5.836498314732617e-9,-1.0138295038417217e-9,4.9585119241642335e-9,-7.159356804818504e-10,-2.8690906631193913e-9,1.0317220219041455e-9,1.527941044741889e-9,-5.330573759793368e-10,-1.6130473731388702e-9,4.7839344014173e-10,1.7613812858445425e-9,-5.06146042238945e-10,-1.0016021804329072e-9,-2.932431507688671e-10,-9.922321119781587e-11,1.087780814211673e-9,1.3298862544487e-9,-4.3831794520885653e-10,-3.273924363329382e-9,-1.1227444403755815e-9,4.7101864626672036e-9,2.207078711251127e-9,-2.767230568570408e-9,-2.930933683915623e-9,-2.517748837939449e-9,3.1911324578241086e-9,6.992019071936063e-9,-1.0836185114648759e-9,-7.096541871763123e-9,-2.9707557592281626e-9,2.547853802116886e-9,4.033900294938033e-9,4.7092778745524885e-9,6.258121569060836e-10,-9.600957198343722e-9,-6.342598711057478e-9,6.021002618469137e-9,6.289862798691125e-9,3.4569191270452572e-9,1.1774197776359671e-9,-6.842572454534799e-9,-9.76112365995308e-9,-3.7767719825850007e-10,8.461270812353991e-9,6.640661151558419e-9,3.8034182075718115e-9,-1.161872286762633e-9,-9.571301123158266e-9,-8.303940106624686e-9,-1.602380766745253e-9,5.25746214314208e-9,9.58460505332016e-9,6.7435380179167625e-9,1.8952208120978137e-9,-4.236740922931874e-9,-9.734634897124934e-9,-9.634539648473921e-9,-2.9397302833849167e-9,3.1473688240748255e-9,6.315174482304347e-9,1.05984650112722e-8,8.622556053297323e-9,3.7233762955897754e-9,-2.4023873040949576e-9,-8.869509537046963e-9,-8.426120605731446e-9,-1.0678432505303057e-8,-1.1472686925304172e-8,-3.182884940966736e-9,2.6310302785440535e-9,3.5670170363618008e-9,1.0444064272555942e-8,1.684591802281544e-8,1.7138820564910067e-8,2.0743475842068618e-8,2.0417678020042865e-8,2.2049112848373996e-8,2.5704805205903133e-8,2.178719818048725e-8,2.3289768299591627e-8,2.9047921335169883e-8,3.0860039225954544e-8,2.6594044496862123e-8,1.2221108660656895e-9,-9.982858429500062e-8,-4.0675759301941307e-7,-0.0000012172414492680138,-0.0000031440592059411818,-0.000007402541588970858,-0.000016288841047452755,-0.000033909269762523975,-0.00006732691428910394,-0.00012820544337623075,-0.0002351490095466915,-0.0004167707663463662,-0.0007156126026837766,-0.0011929047210462833,-0.0019339512906315348,-0.0030538817649672736,-0.004703151042231064,-0.007072058386857583,-0.010393377276559363,-0.014941949912970607,-0.02103019044827227,-0.02899858465973882,-0.039200471314312806,-0.05198111383712444,-0.06765147168080445,-0.08645799520687619,-0.1085505170490231,-0.13395086167156042,-0.16252541085937444,-0.19396482743223392,-0.22777400407107692,-0.26327463995047895,-0.2996218294276782,-0.3358347823129919,-0.37084038053904445,-0.40352687859108416,-0.4328039350668698,-0.45766431137656677,-0.4772422992295984,-0.49086403674208573,-0.49808570298813726,-0.4987165365111706,-0.4928252114288872,-0.4807294841639628,-0.4629705495490345,-0.4402748370094616,-0.41350675124828085,-0.38361655317959253,-0.3515874590098619,-0.3183858171574442,-0.28491754814266346,-0.25199308194311093,-0.220302204368118,-0.19039910700442053,-0.16269720989192654,-0.13747258414842264,-0.11487432095313063,-0.09494001787732735,-0.07761440734666138,-0.06276939600437124,-0.05022392966237087,-0.03976252471452824,-0.031151564526561502,-0.02415291359682342,-0.018534584569495645,-0.014078581015497705,-0.01058609132676684,-0.00788043436204707,-0.005808164178329179,-0.004238739276860847,-0.0030632224155445354,-0.0021922849833726126,-0.001553907924121608,-0.0010909241232727783,-0.0007586399176864575,-0.000522613230403464,-0.00035666178364122963,-0.00024115573243800676,-0.0001615575802968764,-0.0001072449043914024,-0.0000705445918375563,-0.00004598353844958119,-0.000029702805835797248,-0.00001901184980494029,-0.000012056961666678984,-0.000007574731298243513,-0.000004711804238784417,-0.0000029014072751321737,-0.0000017655848385963264,-0.0000010613236607736345,-6.274366432457045e-7,-3.636129302350987e-7,-2.045740309234763e-7,-1.0921017625566055e-7,-5.374983052302937e-8,-2.025613546161569e-8,-2.1400265580872446e-9,9.386111332949656e-9,1.4875762069749038e-8,1.867011785545744e-8,2.0348471439263295e-8,2.13495897416101e-8,2.2060119505639493e-8,2.210302360471219e-8,2.248930998936763e-8,2.2440787923219128e-8,2.2419245406118843e-8,2.277955797233633e-8,2.2169655417621685e-8,2.317486281577744e-8,2.1994021766488172e-8,2.3652922097540355e-8,2.226795509295494e-8,2.4553313121269712e-8,2.3865262372870282e-8,2.7291901292451974e-8,2.935215408136374e-8,3.647746058098961e-8,4.6552552183339695e-8,6.585707869340087e-8,9.84851488714369e-8,1.544539195063167e-7,2.49670566423426e-7,4.085220238354682e-7,6.728155188759634e-7,0.0000011060188117409023,0.000001811106440134533,0.000002946019002743111,0.00000475737519472827,0.000007619293746868034,0.000012102617234493599,0.000019056264518019293,0.0000297486834506828,0.00004602766901151179,0.00007059077762782524,0.00010728876332824483,0.00016160392777629076,0.0002411996108975192,0.0003567078787253662,0.0005226576100107949,0.0007586852931910259,0.0010909693634841248,0.0015539524119045451,0.0021923310091976943,0.0030632663366434,0.004238785573593857,0.005808208141568106,0.007880480350807312,0.010586135765119686,0.014078626483250999,0.018534629468146616,0.024152958723140813,0.031151609656101566,0.03976256965216535,0.05022397503486432,0.06276944056873551,0.07761445323015466,0.09494006188161971,0.1148743672705645,0.1374726280558829,0.16269725580234745,0.19039915186298892,0.22030224892013917,0.2519931282624976,0.2849175915273016,0.318385863990628,0.3515875027254303,0.38361659890162697,0.41350679653699285,0.440274881168014,0.4629705959331894,0.48072952797230195,0.4928252574185475,0.49871658120140094,0.49808574799052635,0.49086408219984745,0.47724234381243874,0.4576643569979468,0.4328039795378449,0.40352692441022453,0.3708404247931996,0.3358348280997956,0.2996218742648429,0.263274684519107,0.22777405045378957,0.1939648707840561,0.16252545742109548,0.13395090622495484,0.1085505613547403,0.08645804211025884,0.0676515147133939,0.05198116018240608,0.039200516594601255,0.028998628121200035,0.02103023780128279,0.01494199316136097,0.010393422935437704,0.007072104257195099,0.004703194565916335,0.00305392828044731,0.0019339956978589813,0.0011929496512680937,0.0007156582593648407,0.0004168153173687509,0.00023519438293189072,0.0001282503693088993,0.00006737212475960611,0.000033954387030123906,0.000016333387513808617,0.000007448745949493393,0.000003187873301262576,0.0000012627445499268632,4.528246732883142e-7,1.4255722335730302e-7,4.578809331698745e-8,1.7673130726385396e-8,1.1953129420551454e-8,1.7623090680654283e-8,1.852377764585027e-8,1.961716619887072e-8,1.7652275748370483e-8,1.4007310778434618e-8,1.4623316376484193e-8,1.2628069158460887e-8,5.1855717828974255e-9,3.113760111382156e-9,2.3485896748439875e-9,-2.5495948796566736e-9,-4.754847720822817e-9,-5.994001484003238e-9,-3.166994951092916e-9,-2.0204384223232076e-9,-2.0824697429034943e-9,2.3431365763465938e-9,3.993248579579665e-9,3.223746997782645e-9,1.042031816870958e-9,-8.509690835228037e-10,-1.8241651031416944e-9,-3.0572412110507376e-9,-4.1412358156127904e-9,-2.7377955672704273e-11,5.503778990886521e-9,1.6475401512363322e-9,1.8439750282920245e-9,3.5962335612543406e-9,-4.826950726668616e-9,-6.681930854943714e-9,-5.313247269007982e-10,1.1893215061393335e-9,1.8814425110493496e-9,6.286488466061527e-9,3.363036838244412e-9,-5.463378517463604e-9,-4.946164985714152e-9,-2.4574671353209824e-9,-2.484665486118102e-10,5.6615675701288305e-9,5.72561141992075e-9,-3.677692447931814e-12,-5.675831424873294e-9,-5.6174538695290815e-9,-1.457453324057931e-10,4.369200202561966e-9,5.8592935996930555e-9,1.1478867458747256e-9,-5.0446979540063785e-9,-5.9871449435409536e-9,-8.663349480463559e-10,7.011845474432589e-9,5.068778567981577e-9,-3.0552987742664947e-9,-4.70892505674269e-9,-2.957771997167124e-9,1.6235103617943056e-9,5.923779475043476e-9,2.543627422972202e-9,-4.606236708013618e-9,-6.387175206232151e-9,1.806587189656198e-9,7.585002740220477e-9,5.831333662842906e-10,-5.640980057877888e-9,-2.3642534157945843e-9,2.861217566128418e-9,2.553038528744398e-9,-7.617037742771979e-10,-3.4289642210129125e-10,-1.5136798877207524e-9,-2.524946046802561e-9,4.2399609924835945e-9,3.524819479825308e-9,-5.635951002724351e-9,-2.7637636131609617e-9,4.5960249082896235e-9,2.3803154935500155e-9,-2.677737798729201e-9,-3.152165867753704e-9,2.0417269927647476e-9,3.6506404106045376e-9,-2.730553737133163e-9,-2.655298704696109e-9,3.122307772022261e-9,8.830284966931006e-10,-2.362265272182219e-9,1.115790700563178e-10,1.3382479594516723e-9,0];
var doubleGaussianVelocities = [0,6.50793231990797e-8,1.5056113264830657e-8,-6.607970810478707e-8,-3.277834849498281e-8,6.721395782434087e-8,5.678377099967388e-8,-7.663458283584043e-8,-7.716925881374469e-8,9.392690688651266e-8,7.617014977881433e-8,-9.654370939922157e-8,-6.079392292187178e-8,6.978148304864571e-8,6.379351338801464e-8,-4.621153998948577e-8,-8.739369878717344e-8,7.105748889326654e-8,8.046815082576288e-8,-1.2347130363788878e-7,-1.6891480556047004e-8,1.3072186421649337e-7,-3.9477890941651903e-8,-7.734510732834609e-8,1.610490918569266e-8,2.5555236793804247e-8,5.524915884657101e-8,-1.049569584380085e-10,-9.133515009656712e-8,-4.619425180096556e-8,8.071254285911885e-8,1.0837509507178708e-7,-5.1388940793261494e-8,-9.77258653536988e-8,-1.4929697491863315e-8,-7.977760902659133e-9,1.0370040144912365e-7,1.1985009481260373e-7,-1.0627508152122652e-7,-1.7112366492423647e-7,-6.041697925156104e-9,1.3891203539367843e-7,8.525923501488789e-8,9.584997479784679e-9,-2.6784442909820057e-8,-1.906952568642403e-7,-8.6532534911152e-8,1.8757082588574612e-7,1.2521116338071278e-7,1.2115767525598965e-8,-1.8773082988190404e-8,-1.3132812324411124e-7,-1.7616242592695487e-7,4.209045678002638e-8,2.0216665670669926e-7,5.47374128831939e-8,5.294248197933205e-8,1.4669981452963252e-8,-2.1626717412011031e-7,-1.3789231679186515e-7,3.41086472001156e-8,6.936216778801074e-8,9.642280120832208e-8,1.3577490696489812e-7,7.497895855869603e-8,-9.199941274275593e-8,-1.3510279706617338e-7,-1.0478564518939219e-7,-4.554218424820083e-8,-4.616350716660493e-8,3.331920885155029e-8,2.0406032728750663e-7,7.191282302749785e-8,3.567387512408126e-8,9.95487193684782e-8,-3.0381340074723554e-8,-8.030740596825679e-8,-9.028134873950244e-8,-1.248295182061422e-7,-7.721753179304819e-8,-5.991229438052797e-8,-1.6409819097902587e-7,-1.2842718070685674e-8,4.650345294442956e-8,-1.241552656541536e-7,1.5953639043159213e-9,2.339744495254339e-8,-2.425812059344875e-8,-2.8080211987627336e-8,-9.88696653540232e-8,-2.1235609575095564e-8,2.6343923219098613e-7,0.0000010510756276812366,0.000003571533969784328,0.00001016931742685843,0.000025233236303147616,0.00005775356190555671,0.00012385590415023453,0.0002517614292234006,0.0004878911161555387,0.0009063601480246112,0.0016208888262867456,0.0027986849993943148,0.004677363081331782,0.007580834632851442,0.011935491975855469,0.01828028292562352,0.027267804319856613,0.03965352694830981,0.05626676885394925,0.07796156976409493,0.10554628614409402,0.13969060642582376,0.18081834103751485,0.2289917116878761,0.2837983384997761,0.3442583036811189,0.4087617961519319,0.4750568705540407,0.5402952795482567,0.6011432606378257,0.6539570952914593,0.6950132953714266,0.7207779668649946,0.7281919319716569,0.7149436673154772,0.6797025898860777,0.6222861462270615,0.5437414613285174,0.44632919156268136,0.33340891529578015,0.20923427456649005,0.07867653980844574,-0.05309652949337019,-0.18095954383983712,-0.30015154324135573,-0.40655870376642494,-0.4969313679288834,-0.5690240575924872,-0.621652074564398,-0.6546662868396582,-0.6688587266594264,-0.6658120519527754,-0.6477129912501196,-0.6171495839712698,-0.5769083617028556,-0.5297904563389951,-0.4784540582609963,-0.4252943550243426,-0.37236043945788505,-0.32131069702673326,-0.2734008599452176,-0.22950030935072097,-0.19012825628493585,-0.15550413116776662,-0.12560431241118492,-0.10022041861652504,-0.0790146924654547,-0.06156863921369501,-0.04742472305377864,-0.03611840966603141,-0.02720259490961592,-0.020264033504288573,-0.014932756748098224,-0.010887426480438382,-0.00785469911644108,-0.005608241239804263,-0.003963226166184697,-0.0027725011597238346,-0.0019200823763445049,-0.001316640893485761,-0.0008940054715965405,-0.0006011906964823061,-0.00040040388909244606,-0.0002641800945581691,-0.0001726485184665152,-0.00011180518340743933,-0.00007172205775829563,-0.00004558374156807362,-0.000028724239142703312,-0.00001788728315410963,-0.000011101011642268051,-0.0000067342435774785455,-0.000004149147820967662,-0.0000024159320889656256,-0.0000015066060442247246,-8.166676956863841e-7,-5.341846701379626e-7,-2.571754130868379e-7,-1.8385650554216e-7,-7.661347697966349e-8,-5.850999463688196e-8,-2.440568800260958e-8,-1.4607518435681656e-8,-9.975938586378201e-9,-1.8849618844449826e-9,-3.2198207238964786e-9,-2.3166348218031293e-9,4.126921718137567e-9,-8.473770692580496e-9,1.3200842894146059e-8,-1.615402670625349e-8,2.3597494723145784e-8,-2.114982923544242e-8,3.6367653235245114e-8,-1.5732135883632316e-8,5.9099186798109295e-8,1.9325735374429454e-8,1.20080081089412e-7,1.3671237240780085e-7,3.0698752123371553e-7,4.830710153547738e-7,8.674692434591844e-7,0.000001457811127964721,0.000002461150238365773,0.0000041087378549774096,0.0000067691374194613505,0.000011071704717833252,0.000017911575917557135,0.00002870386654237448,0.000045601559922697765,0.00007170550188131697,0.00011182131054970016,0.00017263278500318603,0.0002641944623057036,0.0004003928647454232,0.0006011956498089318,0.0008940095647164778,0.0013166252089693933,0.0019201110414595777,0.0027724598853103364,0.003963277604349142,0.005608184052108021,0.007854756238329895,0.010887375683049745,0.014932795678923892,0.020264010175163546,0.027202601438525053,0.036118418456059107,0.04742470258221495,0.061568666649408625,0.07901466253716886,0.1002204479678004,0.12560428472586416,0.15550415783193564,0.19012822930401882,0.22950033719476154,0.27340083282170513,0.32131071916479514,0.3723604285750949,0.42529434829491847,0.4784540864002697,0.5297904079852079,0.5769084229307916,0.6171495224514657,0.6477130382852602,0.665812031952737,0.6688587136200084,0.6546663298336179,0.6216520133575641,0.5690241201545351,0.49693132047681077,0.4065587254415965,0.30015154908355496,0.18095951722371614,0.05309656539618524,-0.07867657398013628,-0.2092342485533376,-0.3334089323316542,-0.4463291811148209,-0.543741466660431,-0.6222861484263754,-0.6797025744355618,-0.7149437006289855,-0.7281918831153118,-0.7207780188238891,-0.6950132601260469,-0.6539570954342756,-0.6011433016227978,-0.5402952104679464,-0.47505693842858926,-0.40876176233095196,-0.3442582840615888,-0.2837984055339713,-0.22899162780839108,-0.18081840135434665,-0.1396905987165782,-0.10554623921113118,-0.07796164580628309,-0.05626670162768485,-0.03965355668321443,-0.02726781690053801,-0.01828024587392026,-0.011935527823022892,-0.007580816471161271,-0.0046773632851099724,-0.002798693386071736,-0.0016208785499845077,-0.0009063741020984921,-0.0004878698110597782,-0.00025178408483887606,-0.00012385118535896268,-0.00005772208397026638,-0.000025299053217126435,-0.000010104062372832356,-0.0000035931857445326064,-0.000001102101565795492,-1.7506867481509652e-7,-5.829584995282611e-8,8.58369231602215e-8,8.783412533508722e-8,-9.249838483728367e-8,-3.5476341906005187e-8,8.592663120610548e-9,-5.98793633007389e-8,-7.829049125272835e-8,-7.701512122214585e-8,-7.845293701326667e-8,-2.4852051246419516e-9,-9.07120700521813e-8,-6.614015156831992e-8,5.967901783338086e-8,1.9694183320187874e-8,2.3458176864299893e-8,2.0741697885756492e-8,8.11343644269088e-8,3.455527566816509e-8,-8.389411323859674e-8,-2.2322096195408612e-8,7.086343791830779e-9,-7.16021898196433e-8,-3.605432124045444e-8,1.0794552748323591e-7,3.1458706807632326e-8,1.0694003467011378e-8,5.59995754734832e-8,-8.259489325326236e-8,-5.3283599241931056e-8,-3.0219094011774245e-8,-4.9768831223100395e-8,8.983793577622503e-8,1.1438589730451957e-7,-8.07942073891763e-9,-3.521446009328181e-8,-8.243743162802543e-9,-1.405667271148513e-7,-5.866417285190064e-8,1.8366979084338195e-7,6.118484912713944e-8,-1.6799090764676555e-8,1.9906650129856168e-8,-1.202693698457578e-7,-1.2492881436926844e-7,7.550324554030911e-8,1.6643074035783584e-7,2.5507925222930974e-8,-5.440220960982265e-8,-6.979307225902635e-8,-1.27677215348288e-7,5.720923323999507e-8,1.7935540027878737e-7,1.4726116061993421e-8,-7.055707899030611e-8,-1.023598547264014e-7,-6.730910538564132e-8,1.0674083969106156e-7,1.6137945057535356e-7,-3.475996227395279e-8,-1.9542452593290265e-7,-8.435867526358665e-9,1.2468020698320385e-7,1.5974913147573493e-9,3.752612093459445e-8,-6.507778573570104e-9,-1.7414035651875828e-7,2.2592699686900256e-8,2.0826013144332912e-7,5.372369938461331e-10,-1.8418341502115687e-7,-4.896196304130255e-8,1.599839903477725e-7,6.589103115963744e-8,-1.2973883073168833e-7,-4.834144466444868e-8,8.554223425937813e-8,3.174242858624132e-8,-5.868914219047128e-8,-1.4659555164123854e-8,6.052081058003912e-8,-2.492721718251471e-8,-5.342297884581963e-8,6.428407701757825e-8,1.740225919416192e-8,-5.623865725486656e-8,7.159495396697512e-9,7.678331231246412e-9,1.808635313971e-8,2.0596778614170866e-8,-6.163315387395056e-8,0];

var demo = new Demo({
	ui: {
		initialDisplacement: {
			title: "Initial Conditions",
			value:"movingGaussian",
			values:[["Stationary sine wave", "sine"], ["Stationary Gaussian pulse", "gaussian"], ["Stationary sinc pulse", "sinc"], ["Two moving gaussian pulses", "movingGaussian"]]
		},
		animate: {
		    title: "Animate",
		    value: false
		}
	},
	t: 0,
	t0: 0,
	savedPosition: {},
	savedVelocity: {},
	data:[],
	waveSpeed: 20,
	rk1: {
		a: [],
		v: [],
		h: [],
	},
	rk2: {
		a: [],
		v: [],
		h: [],
	},
	rk3: {
		a: [],
		v: [],
		h: [],
	},
	rk4: {
		a: [],
		v: [],
		h: [],
	},
	initialHeights: [],
	initialVelocities: [],
	finalHeights: [],
	finalVelocities: [],

	init: function(){

		

		this.initialHeights = doubleGaussianHeights;
		this.initialVelocities = doubleGaussianVelocities;
		$("#demo").append($(".js-wave-demo"));

		// for (i = 0 ; i < 400 ; i++){
		// 	this.data[i] = {};
		// 	this.data[i].velocity = 0;
		// 	this.initialVelocities[i] = 0;



		// 		if (i > 150 && i < 250){
		// 			this.initialHeights[i] = 1 * Math.exp(- Math.pow((i-200),2)/150);
		// 		} else {
		// 			this.initialHeights[i] = 0;
		// 		}

		// }

		
		this.update();

	},


	animate: function(){
	    this.animateID = window.requestAnimationFrame(this.animate.bind(this));
        this.update();
	},


	//calculate array of accelerations given array of heights
	a_from_h: function(h){
		accelerations = [];
		for (i = 0 ; i < h.length ; i++){
			//compute d2h/dx2
			if (i == 0){
				//for standing wave, height must be zero at boundary
				accelerations[i] = Math.pow(20,2) * h[i+1];
			} else if (i == 399){
				//for standing wave, height must be zero at boundary
				accelerations[i] = Math.pow(20,2) * h[i-1];
			} else {
				accelerations[i] = Math.pow(20,2) * (h[i+1] + h[i-1] - 2 * h[i]);
			}	
		}
		return accelerations;
	},

	accumulateEstimate: function(dt, coeff, velocity, acceleration){
		for (i = 0 ; i < h.length ; i++){
			this.data[i].height += dt * coeff * velocity[i];
			this.data[i].velocity += dt * coeff * height[i];
		}
	},

	update: function(e){

		if (e == "animate" && this.ui.animate.value == true){
		    this.animate();
		    this.t0 = new Date().getTime();
		}

		if (e == "animate" && this.ui.animate.value == false){
			window.cancelAnimationFrame(this.animateID);

		} else if (e == "initialDisplacement"){

			if (this.ui.animate.value == true){
				$("#animate-checkbox").click();
			}
			window.cancelAnimationFrame(this.animateID);
			for (i = 0 ; i < 400 ; i++){
				this.data[i] = {};
				this.data[i].velocity = 0;
				this.initialVelocities[i] = 0;

				if (this.ui.initialDisplacement.value == "sine"){
					this.initialHeights[i] = Math.sin(2*Math.PI*i/400);
				} else if (this.ui.initialDisplacement.value == "gaussian"){

					if (i > 150 && i < 250){
						this.initialHeights[i] = 1 * Math.exp(- Math.pow((i-200),2)/150);
					} else {
						this.initialHeights[i] = 0;
					}
				} else if (this.ui.initialDisplacement.value == "sinc"){
					// if (i > 105 && i < 295){
					if (i > 152 && i < 248){
						if (i == 200){
							this.initialHeights[i] = 1;
						} else {
							this.initialHeights[i] = Math.sin((i-200)/5)/((i-200)/5);				
						}
					} else {
						this.initialHeights[i] = 0;
					}
				} else if (this.ui.initialDisplacement.value == "movingGaussian"){
					this.initialHeights[i] = doubleGaussianHeights[i];
					this.initialVelocities[i] = doubleGaussianVelocities[i];
				}
			}

			
			this.update();
		

		} else {



			t1 = new Date().getTime();
			dt = 1/50;

			pathData = "M0,0";
			pathDataV = "M0,0";
			pathDataA = "M0,0";
			// initialHeights = [];
			// initialVelocities = [];
			p1 = [];
			v1 = [];
			a1 = [];
			p2 = [];
			v2 = [];
			a2 = [];
			p3 = [];
			v3 = [];
			a4 = [];
			p4 = [];
			v4 = [];
			a4 = [];

			//first pass//
			for (i = 0 ; i < 400 ; i++){
				p1[i] = this.initialHeights[i];
				v1[i] = this.initialVelocities[i];
			}

			a1 = this.a_from_h(p1);

			// end of first pass//

			//start of second pass//
			for (i = 0 ; i < 400 ; i++){
				p2[i] = p1[i] + v1[i] * dt/2;
				v2[i] = v1[i] + a1[i] * dt/2;
			}

			a2 = this.a_from_h(p2);
			//end of second pass//

			//start of third pass//
			for (i = 0 ; i < 400 ; i++){
				p3[i] = p1[i] + v2[i] * dt/2;
				v3[i] = v1[i] + a2[i] * dt/2;
			}

			a3 = this.a_from_h(p3);
			//end of third pass//

			//start of fourth pass//
			for (i = 0 ; i < 400 ; i++){
				p4[i] = p1[i] + v3[i] * dt;
				v4[i] = v1[i] + a3[i] * dt;
			}

			a4 = this.a_from_h(p4);
			//end of fourth pass//

			for (i = 0 ; i < 400 ; i++){
				if (i == 0 || i == 399){
					this.finalHeights[i] = this.finalVelocities[i] = 0;	
				} else {
					this.finalHeights[i] = this.initialHeights[i] + (v1[i] + 2*v2[i] + 2*v3[i] + v4[i]) * dt/6;
					this.finalVelocities[i] = this.initialVelocities[i] + (a1[i] + 2*a2[i] + 2*a3[i] + a4[i]) * dt/6;
				}

				pathData += "L" + i + ", " + (-100*this.finalHeights[i].toFixed(4));
			}

			this.initialHeights = this.finalHeights;
			this.initialVelocities = this.finalVelocities;

			$("#height").attr("d", pathData);
			$("#velocity").attr("d", pathDataV);
			$("#acc").attr("d", pathDataA);


		this.t0 = t1;




	}

	}
});

